
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
  <meta charset="UTF-8">
  <style type="text/css">
    body{background-color: rgb(43,119,143);}
  </style>
  <title>§8.2 可利用空间表及分配方法</title>
</head>

<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
  <table width="100%" height="100%" border="0" cellpadding="0" cellspacing="0">
    <tr> 
      <td>
        <div align="center">
          <table width="75%" border="1" cellpadding="10" cellspacing="3" bordercolor="#CCCCCC">
            <tr> 
              <td height="38" valign="top" bordercolor="#FFFFFF" bgcolor="#EEEEEE"> 
                <div align="center"> 
                  <p class="css"><strong>数 据 结 构 与 算 法</strong></p>
                </div>
              </td>
            </tr>
            <tr> 
              <td height="166" valign="top" bordercolor="#FFFFFF" bgcolor="#FFFFFF" class="css">
              <h1>第八章        动态存储管理</h1>
              <h2>§8.2 可利用空间表及分配方法</h2>
              本节将讨论利用可利用空间表进行动态存储分配方法。 <br>
              1.▲:可利用空间表操作思想： <br>
              可利用空间表中包含所有可分配的空间块每一块是链表中的一个结点。当用户请求分配时，系统从可利用空间表中删除一个结点分配之；当用户释放其所占内存时，系统即回收并将它插入到可利用空间表中，因此，可利用空间表亦称为“存储池”。<br>
              2.▲:可利用空间表的3种结点结构 <br>
              (1) 结点大小相同： <br>
              当系统中所有用户所需内存量大小相同，可以把内存分为大小相同的若干块，将各块链接起来，分配时从头上摘取，用完后插入到头上，这实际是链栈。 <br>
              (2) 结点有若干规格： <br>
              当用户所需内存量不同，但只允许在几种规格间选取。一般情况下，系统需建立若干个利用空间表，同一链表中的结点大小相同。如大小为2、4、8字节，可以构造3个链表。用加标记办法区分占用块或空闲块（tag=0,1）。分配时按类型分配，所需类型没有时，向较大块的类型中去找，取出所需，剩余插入合适链表中。<br>
              可见，每个结点包含四个域，分别为标志域、结点类型域、链域、值域。标志域的值为0、1 指示当前区是占用块还是空闲块；结点类型域的值为0、1、2分别表示结点的大小为2个字、4个字、8个字；链域中存储指向同一链表中下一个结点的指针。此时的分配和回收的方法很大程度上相似于第一种情况。只是当结点大小和请求分配的量相同的链表为空时，需要查询结点较大的链表，并从中取出一个结点，将其中一部分内存分配给用户，而将剩余部分插入到相应大小的链表中。当结点与请求相符的链表和结点更大的链表均为空时，分配不能进行，此时系统必须执行“存储紧缩”操作，才能使系统继续运行。<br>
              (3)结点大小不等： <br>
              系统分配给用户的内存块大小不固定，可以随请求而变。内存块大小不固定，只有一个链表。通常操作系统的可利用空间表属于此类。即可利用空间表中只有一个大小为整个存储区的结点。随着分配和回收的进行，可利用空间表的结点大小和个数也随之而变化。结点结构为：tag域指示相应块是否为空闲块；size指示相应块的大小。由于可利用空间表中的结点的大小不同，因此所使用的分配策略也不同，通常有以下三种。<br>
              3.▲:利用空间表的3种分配策略 <br>
              首先适配法：从表头指针开始查找可利用空间表，将找到的第一个大小不小于n的空间块的一部分分给用户。可利用空间表本身既不按结点的初始地址有序，也不按结点的大小有序。则在回收时，只要将释放的空闲块插入链表的表头即可。见P197  图8.5（a）<br>
              最佳泥合法：  将可利用空间表中一个不小于n且最接近n的空间块的一部分分给用户。则系统在分配前首先要对可利用空间表从头到尾扫视一遍，然后从中找出一块不小于n且最接近n 的空间进行分配。见P197  图8.5（b）,此时应预先设定可利用空间表的结构按空间块的大小自小至大有序；回收时，将释放的空闲块插入链表的适当位置上。<br>
              最差拟合法：  将可利用空间表中不小于n且是链表中最大的空间块的一部分分给用户。见P197  图8.5（c），此时应预先设定可利用空间表的结构按空间块的大小自大至小有序；回收时，将释放的空闲块插入链表的适当位置上。<br>
              4、3种分配策略的比较 <br>
              最先适配法适合事先不掌握请求分配和释放信息的情况，分配时查询，释放时插入表头。这种分配策略适合于系统事先不掌握运行期间可能出现的请求分配和释放的信息的情况。 <br>
              最佳适配法分配和回收时都需要查询。分配时容易产生存储量小而无法利用的内存小碎片。这种分配策略适合请求分配内存大小较广的系统。 <br>
              最差适配法要求结点从大到小排序，适合请求分配内存大小范围较窄的系统。分配时不需查询，回收时查询，以便插入到适当位置。<br>
              可见，不同的情景需采用不同的方法，通常需考虑下列因素：用户的逻辑要求；请求分配量的大小分布；分配和释放的频率以及效率对系统得重要性。 <br>
              在实际使用的系统中回收空闲块时还须考虑“结点合并”问题，即：将地址相邻的空闲块合并成尽可能大的结点。<br>
              </td>
            </tr>
          </table>
        </div>
      </td>
    </tr>
  </table>
</body>
</html>
